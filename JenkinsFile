import groovy.json.JsonSlurperClassic

def jsonParse(def json) {
    new groovy.json.JsonSlurperClassic().parseText(json)
}

pipeline {

    agent any 
    environment {
        appName = "variable" 
    }
    stages {
        stage("Paso 1 - Lectura de parametros"){          
              steps {
                  script {			
                      bat "echo hola mundo desde GIT"
                      //bat "cd %WORKSPACE%"
                      //bat "dir"
                      bat "echo ##################Aca podemos hacer lectura de algunos parametros -- ##################"      
                  }
              }
        }

        stage("Paso 2 - Compilación de código"){       
              steps {
                  script {			
                      bat "echo COMPILANDO CODIGO"   
                      bat "cd %WORKSPACE%"
                      //bat "dir"
                      bat 'javac HolaMundo.java'
                      //bat 'dir'   
                      //bat 'timeout /t 5'             
                      bat 'jar -cf HolaMundo.jar HolaMundo.class'    
                      bat 'jar cmf temp.mf HolaMundo.jar HolaMundo.class'
                      bat 'java -jar HolaMundo.jar'
                      bat "echo #### Compilación exitosa ###"
                      bat 'copy HolaMundo.jar C:\\tmp\\'
                  }
              }
        }
    }

    post {
        always {          
            deleteDir()
            bat "echo ESTA FASE SIEMPRE SE EJECUTA SIN IMPORTAR SI FUE FALLIDO O NO"
            bat "dir"
        }
        success {
            bat "echo ESTA FASE SE EJECUTA SOLAMENTE SI FUE EXITOSO"
            bat "dir"
        }
        failure {
            bat "echo ESTA FASE SE EJECUTA SI FUE FALLIDO"
            bat "dir"
        }
    }
}
